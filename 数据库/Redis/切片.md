## 如何保存更多的数据
- 纵向扩展
    在内存不是特别大的情况下可以加大内存，比如5G以下，但是如果本身内存就比较大（30G），此时加大内存会影响redis住线程在生成RDB文件时，fork子线程时候出现阻塞情况。此时再加内存会更加延迟。

- 横向扩展
    增加redis实例。比如50G的redis拆分成10个5G的redis实例，这样在fork子线程的时候是很快的。

    1. 数据切片和实例的对应分布关系 


        Redis Cluster方案采用哈希槽（Hash Slot，接下来我会直接称之为Slot），来处理数据和实例之间的映射关系。在Redis Cluster方案中，一个切片集群共有16384个哈希槽，这些哈希槽类似于数据分区，每个键值对都会根据它的key，被映射到一个哈希槽中。

        具体的映射过程分为两大步：首先根据键值对的key，按照CRC16算法计算一个16 bit的值；然后，再用这个16bit值对16384取模，得到0~16383范围内的模数，每个模数代表一个相应编号的哈希槽。

    2. 客户端如何定位数据？  

        Redis Cluster 客户端在连接redis实例之后，redis会把当前实例对应的hash槽发送给客户端，当各个redis切片都互通之后，客户端就能缓存所有的hash槽信息了。

        集群中有新增或删除需要重新分配hash槽；

        负载均衡会导致重新分配hash槽。

        通过重定向：客户端发给一个不存在hash槽的实例请求时，该实例会告诉他实际存在hash槽的实例ip，客户端重新请求。


